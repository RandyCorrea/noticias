<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CMS v4 - Noticias RandyCorrea</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .tab-btn { @apply px-4 py-2 rounded-lg font-semibold transition; }
    .tab-btn.active { @apply bg-blue-600 text-white hover:bg-blue-700; }
    .tab-btn.inactive { @apply bg-gray-200 text-gray-700 hover:bg-gray-300; }
    .form-group { @apply mb-4; }
    .form-label { @apply block text-sm font-semibold text-gray-800 mb-2; }
    .form-input { @apply w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500; }
    .form-textarea { @apply w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none; }
    .btn { @apply px-4 py-2 rounded-lg font-semibold transition; }
    .btn-primary { @apply bg-blue-600 text-white hover:bg-blue-700; }
    .btn-secondary { @apply bg-gray-400 text-white hover:bg-gray-500; }
    .info-box { @apply bg-blue-50 border-l-4 border-blue-600 p-3 rounded; }
    .success-message { @apply text-green-600 bg-green-50 p-2 rounded border border-green-300; }
    .error-message { @apply text-red-600 bg-red-50 p-2 rounded border border-red-300; }
  </style>
</head>
<body class="bg-gradient-to-br from-purple-500 to-pink-500 min-h-screen p-4">
  <div id="app" class="max-w-4xl mx-auto bg-white rounded-2xl shadow-2xl overflow-hidden">
    <!-- Header -->
    <header class="bg-gradient-to-r from-purple-600 to-pink-600 text-white p-6 text-center">
      <h1 class="text-3xl font-bold mb-2">ğŸš€ CMS - Portal de Noticias</h1>
      <p class="opacity-90">Gestor de contenido para RandyCorrea.github.io/noticias</p>
    </header>

    <!-- Tabs -->
    <div class="flex border-b border-gray-200 p-4 gap-2">
      <button id="btnCrear" class="tab-btn active" onclick="switchTab('create')">â• Crear</button>
      <button id="btnGestionar" class="tab-btn inactive" onclick="switchTab('manage')">ğŸ“‹ Gestionar</button>
    </div>

    <!-- Create Tab -->
    <div id="createTab" class="p-6">
      <h2 class="text-2xl font-bold mb-6 text-gray-800">ğŸ“ Crear Nueva Noticia</h2>

      <!-- GitHub Token Info -->
      <div class="info-box mb-6">
        <p><strong>ğŸ” Tu GitHub Token:</strong> ObtÃ©n en: github.com/settings/tokens (permisos: repo)</p>
      </div>

      <!-- GitHub Token Input -->
      <div class="form-group">
        <label class="form-label">GitHub Token *</label>
        <input type="password" id="token" class="form-input" placeholder="tu_token_github" required>
      </div>

      <!-- Title -->
      <div class="form-group">
        <label class="form-label">TÃ­tulo *</label>
        <input type="text" id="title" class="form-input" placeholder="TÃ­tulo de la noticia" required oninput="CMS.generateSlug()">
      </div>

      <!-- Slug Display -->
      <div class="form-group">
        <label class="form-label">Slug</label>
        <div id="slugDisplay" class="form-input bg-gray-100 text-gray-600">Se generarÃ¡ automÃ¡ticamente</div>
      </div>

      <!-- Content -->
      <div class="form-group">
        <label class="form-label">Contenido *</label>
        <textarea id="content" class="form-textarea h-32" placeholder="Escribe el contenido aquÃ­..." required></textarea>
      </div>

      <!-- Excerpt -->
      <div class="form-group">
        <label class="form-label">Excerpt/Resumen *</label>
        <textarea id="excerpt" class="form-textarea h-24" placeholder="Resumen corto de la noticia..." required></textarea>
      </div>

      <!-- Content Type Selector -->
      <div class="form-group">
        <label class="form-label">Tipo de Contenido *</label>
        <select id="contentType" class="form-input" onchange="CMS.toggleContentFields()" required>
          <option value="text-image">ğŸ“ Texto + Imagen</option>
          <option value="youtube">ğŸ¥ Video de YouTube</option>
        </select>
      </div>

      <!-- Image File Upload (hidden for YouTube) -->
      <div id="imageGroup" class="form-group">
        <label class="form-label">ğŸ“¤ Subir Imagen</label>
        <input type="file" id="imageFile" class="form-input" accept="image/*" onchange="CMS.previewImage()">
        <p class="text-sm text-gray-500 mt-2">O usa la URL de imagen:</p>
        <input type="url" id="image" class="form-input" placeholder="https://ejemplo.com/imagen.jpg">
        <div id="imagePreview" class="mt-3 hidden">
          <img id="imagePreviewImg" src="" alt="Preview" class="max-h-40 rounded-lg">
        </div>
      </div>

      <!-- YouTube ID (hidden by default) -->
      <div id="youtubeGroup" class="form-group hidden">
        <label class="form-label">ğŸ¥ YouTube Video ID</label>
        <input type="text" id="youtubeId" class="form-input" placeholder="dQw4w9WgXcQ">
        <p class="text-sm text-gray-500 mt-2">Ejemplo: de https://www.youtube.com/watch?v=<strong>dQw4w9WgXcQ</strong></p>
      </div>

      <!-- Author Name (Pre-filled, disabled) -->
      <div class="form-group">
        <label class="form-label">ğŸ‘¤ Autor</label>
        <input type="text" id="author" class="form-input bg-gray-100" value="Randy Correa" disabled>
      </div>

      <!-- Author Handle -->
      <div class="form-group">
        <label class="form-label">@ Handle</label>
        <input type="text" id="handle" class="form-input" placeholder="@tunombre" value="@RandyCorrea">
      </div>

      <!-- Author Profile Photo -->
      <div class="form-group">
        <label class="form-label">ğŸ“¸ Foto de Perfil del Autor</label>
        <input type="file" id="avatarFile" class="form-input" accept="image/*" onchange="CMS.previewAvatar()">
        <p class="text-sm text-gray-500 mt-2">O usa la URL:</p>
        <input type="url" id="avatar" class="form-input" placeholder="https://ejemplo.com/avatar.jpg">
        <div id="avatarPreview" class="mt-3 hidden">
          <img id="avatarPreviewImg" src="" alt="Avatar Preview" class="w-20 h-20 rounded-full">
        </div>
      </div>

      <!-- Message Display -->
      <div id="publishMessage" class="mb-4"></div>

      <!-- Publish Button -->
      <button onclick="CMS.publishArticle()" class="btn btn-primary w-full text-lg">ğŸš€ Publicar</button>
    </div>

    <!-- Manage Tab -->
    <div id="manageTab" class="p-6 hidden">
      <h2 class="text-2xl font-bold mb-6 text-gray-800">ğŸ“‹ Gestionar ArtÃ­culos</h2>

      <!-- GitHub Token for Manage -->
      <div class="form-group">
        <label class="form-label">GitHub Token *</label>
        <input type="password" id="tokenManage" class="form-input" placeholder="tu_token_github" required>
      </div>

      <!-- Load Articles Button -->
      <button onclick="CMS.loadArticles()" class="btn btn-primary mb-6">ğŸ”„ Cargar ArtÃ­culos</button>

      <!-- Articles List -->
      <div id="articlesList" class="space-y-4"></div>
    </div>
  </div>

  <script src="cms-v4.js"></script>
  <script>
    function switchTab(tab) {
      document.querySelectorAll('[id$="Tab"]').forEach(t => t.style.display = 'none');
      document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active') && b.classList.add('inactive'));
      
      document.getElementById(tab + 'Tab').style.display = 'block';
      document.getElementById('btn' + (tab === 'create' ? 'Crear' : 'Gestionar')).classList.add('active');
      document.getElementById('btn' + (tab === 'create' ? 'Crear' : 'Gestionar')).classList.remove('inactive');
      
      if (tab === 'manage') CMS.loadArticles();
    }

    // Override updateContentOptions for cms-v4
    window.updateContentOptions = function() {
      const type = document.getElementById('contentType')?.value;
      const imageGroup = document.getElementById('imageGroup');
      const youtubeGroup = document.getElementById('youtubeGroup');
      if (imageGroup) imageGroup.style.display = type === 'youtube' ? 'none' : 'block';
      if (youtubeGroup) youtubeGroup.style.display = type === 'youtube' ? 'block' : 'none';
    };

    // Initialize on load
    document.addEventListener('DOMContentLoaded', () => {
      if (typeof CMS !== 'undefined' && CMS.init) CMS.init();
    });
  </script>
</body>
</html>
