<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CMS v4 - Noticias RandyCorrea</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .error { @apply text-red-600 bg-red-50 p-3 rounded-lg mb-4; }
        .success { @apply text-green-600 bg-green-50 p-3 rounded-lg mb-4; }
        .btn { @apply px-4 py-2 rounded-lg font-semibold transition; }
        .btn-primary { @apply bg-blue-600 text-white hover:bg-blue-700; }
        .btn-small { @apply px-3 py-1 text-sm; }
        .btn-danger { @apply bg-red-600 text-white hover:bg-red-700; }
        .btn-info { @apply bg-cyan-600 text-white hover:bg-cyan-700; }
        .news-item { @apply bg-gray-100 p-4 rounded-lg mb-3 border-l-4 border-blue-600; }
        .news-item h3 { @apply font-bold mb-2; }
        .news-item-actions { @apply flex gap-2 mt-3 flex-wrap; }
    </style>
</head>
<body class="bg-gradient-to-br from-purple-500 to-pink-500 min-h-screen p-4">
    <div class="max-w-4xl mx-auto bg-white rounded-2xl shadow-2xl overflow-hidden">
        <header class="bg-gradient-to-r from-purple-600 to-pink-600 text-white p-6 text-center">
            <h1 class="text-3xl font-bold mb-2">ğŸš€ CMS v4 - Noticias</h1>
            <p class="opacity-90">Gestor completo con GitHub Integration</p>
        </header>
        
        <div class="flex border-b">
            <button onclick="switchTab('create')" class="flex-1 py-4 px-6 font-semibold text-purple-600 border-b-2 border-purple-600 tab-btn active">â• Crear</button>
            <button onclick="switchTab('manage')" class="flex-1 py-4 px-6 font-semibold text-gray-600 hover:text-purple-600 tab-btn">ğŸ“‹ Gestionar</button>
        </div>
        
        <div class="p-6">
            <!-- TAB: CREAR -->
            <div id="createTab" class="tab-content">
                <div class="bg-blue-50 p-4 rounded-lg mb-4 border-l-4 border-blue-600">
                    <strong>ğŸ” GitHub Token:</strong> ObtÃ©n en <a href="https://github.com/settings/tokens" target="_blank" class="text-blue-600 underline">github.com/settings/tokens</a>
                </div>
                
                <div class="space-y-4">
                    <div>
                        <label class="block font-semibold mb-2">ğŸ” GitHub Token *</label>
                        <input type="password" id="githubToken" placeholder="ghp_xxxx..." class="w-full p-2 border border-gray-300 rounded-lg">
                    </div>
                    
                    <div>
                        <label class="block font-semibold mb-2">ğŸ“ TÃ­tulo *</label>
                        <input type="text" id="title" placeholder="TÃ­tulo de la noticia" class="w-full p-2 border border-gray-300 rounded-lg">
                    </div>
                    
                    <div>
                        <label class="block font-semibold mb-2">Slug (auto-generado)</label>
                        <div id="slugDisplay" class="w-full p-2 bg-gray-100 rounded-lg text-gray-600">Se generarÃ¡ automÃ¡ticamente</div>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block font-semibold mb-2">ğŸ‘¤ Nombre del Autor</label>
                            <input type="text" id="authorName" value="Randy Correa" placeholder="Nombre" class="w-full p-2 border border-gray-300 rounded-lg">
                        </div>
                        <div>
                            <label class="block font-semibold mb-2">@ Handle</label>
                            <input type="text" id="authorHandle" value="@RandyCorrea" placeholder="@handle" class="w-full p-2 border border-gray-300 rounded-lg">
                        </div>
                    </div>
                    
                    <div>
                        <label class="block font-semibold mb-2">ğŸ–¼ï¸ Foto de Perfil</label>
                        <div class="flex gap-2">
                            <input type="file" id="avatarFile" accept="image/*" class="flex-1 p-2 border border-gray-300 rounded-lg">
                            <input type="url" id="avatarUrl" placeholder="O pega URL" class="flex-1 p-2 border border-gray-300 rounded-lg">
                        </div>
                    </div>
                    
                    <div>
                        <label class="block font-semibold mb-2">ğŸ“„ Contenido *</label>
                        <textarea id="content" placeholder="Escribe el contenido" class="w-full p-2 border border-gray-300 rounded-lg h-32"></textarea>
                    </div>
                    
                    <div>
                        <label class="block font-semibold mb-2">ğŸ“‹ Resumen *</label>
                        <textarea id="excerpt" placeholder="Resumen corto" class="w-full p-2 border border-gray-300 rounded-lg h-20"></textarea>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block font-semibold mb-2">ğŸ“Œ Tipo de Contenido</label>
                            <select id="contentType" class="w-full p-2 border border-gray-300 rounded-lg">
                                <option value="text">Texto + Imagen</option>
                                <option value="video">Video (YouTube)</option>
                            </select>
                        </div>
                        <div id="imageGroup">
                            <label class="block font-semibold mb-2">ğŸ–¼ï¸ Imagen</label>
                            <div class="flex gap-2">
                                <input type="file" id="imageFile" accept="image/*" class="flex-1 p-2 border border-gray-300 rounded-lg text-sm">
                                <input type="url" id="imageUrl" placeholder="URL" class="flex-1 p-2 border border-gray-300 rounded-lg text-sm">
                            </div>
                        </div>
                    </div>
                    
                    <div id="youtubeGroup" style="display:none;">
                        <label class="block font-semibold mb-2">ğŸ¥ ID YouTube</label>
                        <input type="text" id="youtubeId" placeholder="Ej: Ihy0QziLDf0" class="w-full p-2 border border-gray-300 rounded-lg">
                    </div>
                    
                    <div id="message"></div>
                    
                    <button onclick="CMS.publishArticle()" class="btn btn-primary w-full">ğŸš€ Publicar</button>
                </div>
            </div>
            
            <!-- TAB: GESTIONAR -->
            <div id="manageTab" class="tab-content" style="display:none;">
                <div class="bg-blue-50 p-4 rounded-lg mb-4 border-l-4 border-blue-600">
                    <strong>ğŸ” GitHub Token:</strong> Necesario para editar/eliminar
                </div>
                
                <div class="mb-4">
                    <input type="password" id="githubTokenManage" placeholder="ghp_xxxx..." class="w-full p-2 border border-gray-300 rounded-lg mb-2">
                    <button onclick="CMS.loadArticles()" class="btn btn-info w-full">ğŸ”„ Cargar Noticias</button>
                </div>
                
                <div id="newsList"></div>
            </div>
        </div>
    </div>
    
    <script src="cms-v4.js"></script>
    <script>
        function switchTab(tab) {
            document.querySelectorAll('.tab-content').forEach(t => t.style.display = 'none');
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('border-purple-600', 'text-purple-600'));
            
            document.getElementById(tab + 'Tab').style.display = 'block';
            event.target.classList.add('border-purple-600', 'text-purple-600');
            
            if (tab === 'manage') CMS.loadArticles();
        }
        
        // Override updateContentOptions desde cms-v4
        window.updateContentOptions = function() {
            const type = document.getElementById('contentType')?.value;
            const imageGroup = document.getElementById('imageGroup');
            const youtubeGroup = document.getElementById('youtubeGroup');
            if (imageGroup) imageGroup.style.display = type === 'video' ? 'none' : 'block';
            if (youtubeGroup) youtubeGroup.style.display = type === 'video' ? 'block' : 'none';
        };
        
        // Escuchar cambios en contentType
        document.getElementById('contentType').addEventListener('change', updateContentOptions);
    </script>
</body>
</html>
